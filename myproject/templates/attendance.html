{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Attendance Management - ASCReM</title>
<link rel="icon" type="image/png" href="{% static 'images/ASCReM_Logo.png' %}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<link rel="stylesheet" href="{% static 'images/css/attendance.css' %}">
<style>
/* ==================== BASE RESET ==================== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
}

body {
  background: linear-gradient(135deg, #0a0f3c 0%, #1e2fa3 50%, #0a0f3c 100%);
  background-attachment: fixed;
  color: #fff;
  display: flex;
  min-height: 100vh;
  overflow-x: hidden;
}

/* ==================== MOBILE HEADER ==================== */
.mobile-header {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 60px;
  background: linear-gradient(180deg, #0d122e 0%, #0a0f1f 100%);
  z-index: 1001;
  padding: 0 15px;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
  border-bottom: 1px solid rgba(255, 215, 0, 0.2);
}

.mobile-logo {
  display: flex;
  align-items: center;
  gap: 10px;
}

.mobile-logo img {
  width: 40px;
  filter: drop-shadow(0 2px 6px rgba(255, 215, 0, 0.4));
}

.mobile-logo h2 {
  font-size: 1.2rem;
  color: #ffd700;
  margin: 0;
  font-weight: 800;
  letter-spacing: 1px;
}

.hamburger {
  width: 30px;
  height: 25px;
  position: relative;
  cursor: pointer;
  z-index: 1002;
}

.hamburger span {
  display: block;
  position: absolute;
  height: 3px;
  width: 100%;
  background: #ffd700;
  border-radius: 3px;
  opacity: 1;
  left: 0;
  transform: rotate(0deg);
  transition: .25s ease-in-out;
}

.hamburger span:nth-child(1) {
  top: 0px;
}

.hamburger span:nth-child(2) {
  top: 10px;
}

.hamburger span:nth-child(3) {
  top: 20px;
}

.hamburger.active span:nth-child(1) {
  top: 10px;
  transform: rotate(135deg);
}

.hamburger.active span:nth-child(2) {
  opacity: 0;
  left: -60px;
}

.hamburger.active span:nth-child(3) {
  top: 10px;
  transform: rotate(-135deg);
}

/* Sidebar overlay for mobile */
.sidebar-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  z-index: 1001;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.sidebar-overlay.active {
  display: block;
  opacity: 1;
}

/* ==================== SIDEBAR ==================== */
.sidebar {
  width: 260px;
  background: linear-gradient(180deg, #0d122e 0%, #0a0f1f 100%);
  color: #fff;
  padding: 20px 15px;
  display: flex;
  flex-direction: column;
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  box-shadow: 4px 0 25px rgba(0, 0, 0, 0.7);
  z-index: 1000;
  border-right: 1px solid rgba(255, 215, 0, 0.1);
}

.logo {
  text-align: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 2px solid rgba(255, 215, 0, 0.2);
}

.logo img {
  width: 70px;
  margin-bottom: 8px;
  filter: drop-shadow(0 4px 12px rgba(255, 215, 0, 0.4));
  transition: transform 0.3s ease;
}

.logo img:hover {
  transform: scale(1.05);
}

.logo h2 {
  font-size: 1.2rem;
  color: #ffd700;
  text-transform: uppercase;
  letter-spacing: 2px;
  font-weight: 800;
  text-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
}

.nav-links {
  flex: 1;
  overflow-y: auto;
  padding-right: 5px;
}

.nav-links::-webkit-scrollbar {
  width: 5px;
}

.nav-links::-webkit-scrollbar-track {
  background: rgba(10, 15, 60, 0.3);
  border-radius: 3px;
}

.nav-links::-webkit-scrollbar-thumb {
  background: rgba(255, 215, 0, 0.3);
  border-radius: 3px;
}

.nav-links a {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 11px 14px;
  text-decoration: none;
  color: #e5e7eb;
  border-radius: 8px;
  font-weight: 500;
  font-size: 0.9rem;
  transition: all 0.3s ease;
  margin-bottom: 5px;
  position: relative;
}

.nav-links a i {
  font-size: 1.1rem;
  width: 20px;
  text-align: center;
}

.nav-links a:hover {
  background: rgba(30, 47, 163, 0.5);
  color: #ffd700;
  transform: translateX(5px);
}

.nav-links a.active {
  background: linear-gradient(90deg, #1e2fa3, #2d4bc5);
  color: #ffd700;
  box-shadow: 0 4px 16px rgba(255, 215, 0, 0.3);
  font-weight: 600;
}

.nav-links a.active::after {
  content: '';
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 4px;
  height: 70%;
  background: #ffd700;
  border-radius: 0 4px 4px 0;
}

/* ==================== MAIN CONTENT ==================== */
.main-content {
  margin-left: 260px;
  flex: 1;
  padding: 1.5rem;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  padding-bottom: 15px;
  border-bottom: 2px solid rgba(255, 215, 0, 0.3);
  flex-wrap: wrap;
  gap: 15px;
}

.page-header h2 {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 1.8rem;
  font-weight: 700;
  color: #ffd700;
  margin: 0;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.page-header i {
  font-size: 1.8rem;
}

/* Cards */
.card {
  background: linear-gradient(145deg, #0d122e 0%, #0a0f1f 100%);
  border: 1px solid rgba(255, 215, 0, 0.1);
  border-radius: 15px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  margin-bottom: 25px;
  overflow: hidden;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.card:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 32px rgba(0, 0, 0, 0.5);
}

.card-header {
  background: linear-gradient(90deg, #1e2fa3 0%, #0a0f3c 100%);
  color: #ffd700;
  padding: 18px 20px;
  font-weight: 700;
  font-size: 1.05rem;
  border-bottom: 2px solid rgba(255, 215, 0, 0.2);
}

.card-header h5 {
  margin: 0;
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 1.1rem;
}

.card-header i {
  font-size: 1.2rem;
}

.card-body {
  padding: 20px;
}

/* Form Controls */
.form-label {
  color: #ffd700;
  font-weight: 600;
  font-size: 0.95rem;
  margin-bottom: 8px;
}

.form-control,
.form-select {
  background: rgba(26, 26, 46, 0.8);
  border: 1px solid rgba(255, 215, 0, 0.2);
  color: #fff;
  border-radius: 8px;
  padding: 12px 16px;
  font-size: 0.95rem;
  transition: all 0.3s ease;
}

.form-control:focus,
.form-select:focus {
  background: rgba(26, 26, 46, 0.95);
  border-color: #ffd700;
  color: #fff;
  box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.15);
  outline: none;
}

/* Buttons */
.btn {
  border-radius: 4px;
  padding: 10px 10px;
  font-weight: 600;
  font-size: 0.95rem;
  transition: all 0.3s ease;
  border: none;
}

.btn-primary {
  background: linear-gradient(135deg, #ffd700, #ffed4e);
  color: #0a0f3c;
  box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
}

.btn-primary:hover {
  background: linear-gradient(135deg, #ffed4e, #ffd700);
  color: #0a0f3c;
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(255, 215, 0, 0.4);
}

.btn-primary i {
  margin-right: 6px;
}

/* Status Badges */
.status-badge {
  padding: 6px 14px;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  display: inline-block;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.status-present {
  background: linear-gradient(135deg, #28a745, #20c997);
  color: white;
}

.status-absent {
  background: linear-gradient(135deg, #dc3545, #c82333);
  color: white;
}

.status-late {
  background: linear-gradient(135deg, #ffc107, #ffb300);
  color: #000;
}

.status-excused {
  background: linear-gradient(135deg, #17a2b8, #138496);
  color: white;
}

/* Attendance Table */
.table-responsive {
  border-radius: 10px;
  overflow-x: auto;
  overflow-y: auto;
  margin-bottom: 0;
  max-height: 500px;
  position: relative;
  width: 100%;
  -webkit-overflow-scrolling: touch;
  background: 
    linear-gradient(to right, rgba(13, 18, 46, 1) 30%, rgba(13, 18, 46, 0)),
    linear-gradient(to right, rgba(13, 18, 46, 0), rgba(13, 18, 46, 1) 70%) 100% 0,
    linear-gradient(to bottom, rgba(13, 18, 46, 1) 30%, rgba(13, 18, 46, 0)),
    linear-gradient(to bottom, rgba(13, 18, 46, 0), rgba(13, 18, 46, 1) 70%) 0 100%;
  background-repeat: no-repeat;
  background-size: 40px 100%, 40px 100%, 100% 40px, 100% 40px;
  background-attachment: local, local, local, local;
  scroll-behavior: smooth;
}

.table-responsive::-webkit-scrollbar {
  width: 12px;
  height: 12px;
}

.table-responsive::-webkit-scrollbar-track {
  background: rgba(10, 15, 60, 0.8);
  border-radius: 6px;
  margin: 5px;
}

.table-responsive::-webkit-scrollbar-thumb {
  background: linear-gradient(135deg, rgba(255, 215, 0, 0.7), rgba(255, 215, 0, 0.5));
  border-radius: 6px;
  border: 2px solid rgba(10, 15, 60, 0.8);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.table-responsive::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(135deg, rgba(255, 215, 0, 0.9), rgba(255, 215, 0, 0.7));
  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.4);
}

.table-responsive::-webkit-scrollbar-corner {
  background: rgba(10, 15, 60, 0.8);
  border-radius: 6px;
}

.attendance-table {
  background: rgba(13, 18, 46, 0.5);
  border-radius: 10px;
  overflow: hidden;
  width: 100%;
  min-width: 1000px;
  border-collapse: separate;
  border-spacing: 0;
}

.attendance-table thead {
  background: linear-gradient(90deg, #1e2fa3, #0a0f3c);
  position: sticky;
  top: 0;
  z-index: 10;
}

.attendance-table th {
  color: #ffd700 !important;
  font-weight: 700;
  font-size: 0.9rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  padding: 16px 14px;
  border: none;
  white-space: nowrap;
  background: linear-gradient(90deg, #1e2fa3, #0a0f3c);
}

.attendance-table td {
  padding: 14px;
  border: none;
  border-bottom: 1px solid rgba(255, 215, 0, 0.1);
  vertical-align: middle;
  color: #ffffff !important;
  font-size: 0.9rem;
  background: transparent;
}

.attendance-table td strong {
  color: #ffffff !important;
  font-weight: 600;
}

.attendance-table tbody tr {
  background: rgba(13, 18, 46, 0.5);
  transition: background 0.2s ease;
}

.attendance-table tbody tr:hover {
  background: rgba(30, 47, 163, 0.3);
}

/* Attendance Buttons */
.attendance-btn {
  width: 42px;
  height: 42px;
  padding: 0;
  font-weight: 700;
  font-size: 0.95rem;
  border-width: 2px;
  transition: all 0.3s ease;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.attendance-btn:hover {
  transform: scale(1.1);
}

.attendance-btn.active {
  font-weight: 900;
  transform: scale(1.15);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.btn-outline-success {
  border-color: #28a745;
  color: #28a745;
  background: transparent;
}

.btn-outline-success.active,
.btn-outline-success:hover {
  background: #28a745 !important;
  border-color: #28a745;
  color: white !important;
}

.btn-outline-danger {
  border-color: #dc3545;
  color: #dc3545;
  background: transparent;
}

.btn-outline-danger.active,
.btn-outline-danger:hover {
  background: #dc3545 !important;
  border-color: #dc3545;
  color: white !important;
}

.btn-outline-warning {
  border-color: #ffc107;
  color: #ffc107;
  background: transparent;
}

.btn-outline-warning.active,
.btn-outline-warning:hover {
  background: #ffc107 !important;
  border-color: #ffc107;
  color: #000 !important;
}

.btn-outline-info {
  border-color: #17a2b8;
  color: #17a2b8;
  background: transparent;
}

.btn-outline-info.active,
.btn-outline-info:hover {
  background: #17a2b8 !important;
  border-color: #17a2b8;
  color: white !important;
}

.btn-group {
  gap: 4px;
  display: flex;
}

/* Empty State */
.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: rgba(255, 255, 255, 0.6);
}

.empty-state i {
  display: block;
}

.empty-state h4 {
  font-weight: 600;
}

.empty-state ol {
  font-size: 0.9rem;
  line-height: 1.6;
}

.empty-state ol strong {
  font-weight: 600;
}

/* Save Button Container */
.save-container {
  padding: 20px;
  background: linear-gradient(90deg, rgba(30, 47, 163, 0.2), rgba(10, 15, 60, 0.2));
  border-top: 1px solid rgba(255, 215, 0, 0.1);
  text-align: right;
}

.save-container .btn-primary {
  padding: 12px 30px;
  font-size: 1rem;
}

/* ==================== RESPONSIVE STYLES ==================== */

/* Tablet and below */
@media (max-width: 768px) {
  .mobile-header {
    display: flex;
  }

  .sidebar {
    transform: translateX(-100%);
    transition: transform 0.3s ease;
    z-index: 1002;
    top: 0;
    height: 100vh;
  }

  .sidebar.active {
    transform: translateX(0);
  }

  .main-content {
    margin-left: 0;
    padding: 1rem;
    padding-top: 75px;
  }

  .page-header {
    margin-bottom: 20px;
    flex-direction: column;
    align-items: flex-start;
  }

  .page-header h2 {
    font-size: 1.4rem;
  }

  .page-header i {
    font-size: 1.4rem;
  }

  .card-header {
    padding: 12px 15px;
  }

  .card-header h5 {
    font-size: 0.95rem;
  }

  .card-body {
    padding: 15px;
  }

  .attendance-btn {
    width: 36px;
    height: 36px;
    font-size: 0.85rem;
  }

  .attendance-table {
    min-width: 800px;
  }

  .attendance-table th,
  .attendance-table td {
    padding: 10px 8px;
    font-size: 0.8rem;
  }

  .save-container {
    padding: 15px;
    text-align: center;
  }

  .save-container .btn-primary {
    width: 100%;
  }
}

/* Small Mobile - 320px */
@media (max-width: 320px) {
  .main-content {
    padding: 0.8rem;
    padding-top: 70px;
  }

  .page-header h2 {
    font-size: 1.1rem;
  }

  .page-header i {
    font-size: 1.1rem;
  }

  .card {
    margin-bottom: 15px;
  }

  .card-header {
    padding: 10px 12px;
  }

  .card-header h5 {
    font-size: 0.85rem;
  }

  .card-body {
    padding: 12px;
  }

  .form-control,
  .form-select {
    padding: 8px 10px;
    font-size: 0.85rem;
  }

  .btn {
    padding: 8px 15px;
    font-size: 0.85rem;
  }

  .attendance-btn {
    width: 32px;
    height: 32px;
    font-size: 0.75rem;
  }

  .status-badge {
    padding: 4px 10px;
    font-size: 0.7rem;
  }

  .attendance-table {
    min-width: 700px;
  }

  .attendance-table th,
  .attendance-table td {
    padding: 8px 6px;
    font-size: 0.75rem;
  }

  .mobile-logo h2 {
    font-size: 1rem;
  }

  .mobile-logo img {
    width: 35px;
  }

  .table-responsive {
    max-height: 400px;
  }

  .table-responsive::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
}

/* Medium Mobile - 375px */
@media (min-width: 321px) and (max-width: 375px) {
  .page-header h2 {
    font-size: 1.2rem;
  }

  .attendance-btn {
    width: 34px;
    height: 34px;
    font-size: 0.8rem;
  }

  .attendance-table {
    min-width: 750px;
  }

  .table-responsive {
    max-height: 400px;
  }

  .table-responsive::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
}

/* Large Mobile - 425px */
@media (min-width: 376px) and (max-width: 425px) {
  .page-header h2 {
    font-size: 1.3rem;
  }

  .attendance-btn {
    width: 35px;
    height: 35px;
    font-size: 0.82rem;
  }

  .attendance-table {
    min-width: 800px;
  }

  .table-responsive {
    max-height: 450px;
  }

  .table-responsive::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }
}

/* Laptop - 1024px */
@media (min-width: 769px) and (max-width: 1024px) {
  .sidebar {
    width: 220px;
  }

  .main-content {
    margin-left: 220px;
    padding: 1.3rem;
  }

  .page-header h2 {
    font-size: 1.6rem;
  }
}
</style>
</head>
<body>

<!-- Mobile Header with Hamburger -->
<div class="mobile-header">
  <div class="mobile-logo">
    <img src="{% static 'images/ASCReM_Logo.png' %}" alt="ASCReM Logo">
    <h2>ASCREM</h2>
  </div>
  <div class="hamburger" id="hamburger">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<!-- Sidebar Overlay -->
<div class="sidebar-overlay" id="sidebarOverlay"></div>

<aside class="sidebar" id="sidebar">
    <div class="logo">
        <img src="{% static 'images/ASCReM_Logo.png' %}" alt="ASCReM Logo">
        <h2>ASCREM</h2>
    </div>
    <nav class="nav-links">
        <a href="{% url 'dashboard' %}"><i class="bi bi-speedometer2"></i> Dashboard</a>
        <a href="{% url 'class_panel' %}"><i class="bi bi-journal-text"></i> Classes</a>
        <a href="{% url 'attendance_panel' %}" class="active"><i class="bi bi-calendar-check"></i> Attendance</a>
        <a href="{% url 'grades_panel' %}"><i class="bi bi-bar-chart-fill"></i> Grades</a>
        <a href="{% url 'reports_panel' %}"><i class="bi bi-file-earmark-text"></i> Reports</a>
        <a href="{% url 'profile' %}"><i class="bi bi-person-circle"></i> Profile</a>
        <a href="{% url 'settings' %}"><i class="bi bi-gear"></i> Settings</a>
        <a href="{% url 'about' %}"><i class="bi bi-info-circle"></i> About</a>
        <a href="{% url 'logout' %}"><i class="bi bi-box-arrow-right"></i> Logout</a>
    </nav>
</aside>

<div class="main-content">
    <div class="page-header">
        <h2><i class="bi bi-calendar-check"></i> Attendance Management</h2>
        {% if selected_class %}
        <a href="{% url 'attendance_summary' selected_class.id %}" class="btn btn-primary">
            <i class="bi bi-graph-up"></i> View Summary
        </a>
        {% endif %}
    </div>

    <!-- Class and Date Selection -->
    <div class="card">
        <div class="card-header"><h5><i class="bi bi-funnel"></i> Select Class and Date</h5></div>
        <div class="card-body">
            <form method="GET" class="row g-3">
                <div class="col-md-6">
                    <label class="form-label">Date</label>
                    <input type="date" name="date" class="form-control" value="{{ selected_date|date:'Y-m-d' }}" onchange="this.form.submit()">
                </div>
                <div class="col-md-6">
                    <label class="form-label">Select Class</label>
                    <select name="class_id" class="form-select" onchange="this.form.submit()">
                        <option value="">Choose a class...</option>
                        {% for class in classes %}
                            <option value="{{ class.id }}" {% if selected_class and selected_class.id == class.id %}selected{% endif %}>
                                {{ class.school_year }} {{ class.program|truncatechars:5 }}-{{ class.year_level|slice:"0:1" }}{{ class.section }} {{ class.subject }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
            </form>
        </div>
    </div>

    {% if selected_class %}
    <div class="card">
        <div class="card-header">
            <h5><i class="bi bi-people"></i> Attendance for {{ selected_class.program }} - {{ selected_class.subject }} ({{ selected_class.year_level }} - {{ selected_class.section }}) - {{ selected_date|date:'F d, Y' }}</h5>
        </div>
        <div class="card-body p-0" style="overflow: hidden;">
            {% if attendance_records %}
            <form id="attendanceForm">
                <div class="table-responsive">
                    <table class="table attendance-table mb-0">
                        <thead>
                            <tr>
                                <th>Student ID</th>
                                <th>Name</th>
                                <th>Program</th>
                                <th>Year Level</th>
                                <th>Status</th>
                                <th style="text-align: center;">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for record in attendance_records %}
                            <tr>
                                <td><strong>{{ record.student.student_id }}</strong></td>
                                <td><strong>{{ record.student.first_name }} {{ record.student.last_name }}</strong></td>
                                <td>{{ record.student.program }}</td>
                                <td>{{ record.student.year_level }}</td>
                                <td>
                                    <span class="status-badge status-{{ record.status|lower }}" id="status-{{ record.id }}">{{ record.status }}</span>
                                </td>
                                <td>
                                    <div class="btn-group" role="group">
                                        <button type="button" class="btn btn-sm btn-outline-success attendance-btn {% if record.status == 'Present' %}active{% endif %}" onclick="setStatus({{ record.id }}, 'Present', this)" title="Present">P</button>
                                        <button type="button" class="btn btn-sm btn-outline-danger attendance-btn {% if record.status == 'Absent' %}active{% endif %}" onclick="setStatus({{ record.id }}, 'Absent', this)" title="Absent">A</button>
                                        <button type="button" class="btn btn-sm btn-outline-warning attendance-btn {% if record.status == 'Late' %}active{% endif %}" onclick="setStatus({{ record.id }}, 'Late', this)" title="Late">L</button>
                                        <button type="button" class="btn btn-sm btn-outline-info attendance-btn {% if record.status == 'Excused' %}active{% endif %}" onclick="setStatus({{ record.id }}, 'Excused', this)" title="Excused">E</button>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="save-container">
                    <button type="button" class="btn btn-primary" onclick="saveAttendance()">
                        <i class="bi bi-save"></i> Save Attendance
                    </button>
                </div>
            </form>
            {% else %}
            <div class="empty-state text-center py-5">
                <i class="bi bi-person-plus" style="font-size: 4rem; color: rgba(255, 215, 0, 0.4); margin-bottom: 20px;"></i>
                <h4 style="color: #ffd700; margin-bottom: 15px;">No Students Enrolled</h4>
                <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 20px; font-size: 1rem;">This class doesn't have any students yet. You need to add students before you can take attendance.</p>
                <div style="background: rgba(255, 215, 0, 0.1); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 10px; padding: 20px; margin: 20px auto; max-width: 500px;">
                    <h6 style="color: #ffd700; margin-bottom: 10px;"><i class="bi bi-lightbulb"></i> How to Add Students:</h6>
                    <ol style="text-align: left; color: rgba(255, 255, 255, 0.8); margin: 0; padding-left: 20px; text-decoration: none;">
                        <li style="margin-bottom: 8px;">Go to <strong style="color: #ffd700;">Classes</strong> menu</li>
                        <li style="margin-bottom: 8px;">Click <strong style="color: #ffd700;">"View"</strong> on this class</li>
                        <li style="margin-bottom: 8px;">Add students manually or upload a CSV file</li>
                        <li>Return here to take attendance</li>
                    </ol>
                </div>
                <a href="{% url 'class_panel' %}" class="btn btn-primary" style="margin-top: 15px; padding: 2px 8px; font-size: 0.7rem; line-height: 1; height: auto; min-height: auto; display: flex; align-items: center; justify-content: center; gap: 4px;">
                    <i class="bi bi-journal-text" style="font-size: 0.7rem;"></i> Go to Classes
                </a>
            </div>
            {% endif %}
        </div>
    </div>
    {% else %}
    <div class="card">
        <div class="card-body text-center py-4">
            <i class="bi bi-calendar-check"></i>
            <h4>Select a Class to Manage Attendance</h4>
            <p>Choose a class from the dropdown above to start recording attendance.</p>
        </div>
    </div>
    {% endif %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
// Mobile Menu Toggle
const hamburger = document.getElementById('hamburger');
const sidebar = document.getElementById('sidebar');
const sidebarOverlay = document.getElementById('sidebarOverlay');

function toggleMenu() {
  hamburger.classList.toggle('active');
  sidebar.classList.toggle('active');
  sidebarOverlay.classList.toggle('active');
  document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : '';
}

hamburger.addEventListener('click', toggleMenu);
sidebarOverlay.addEventListener('click', toggleMenu);

// Close menu when clicking on a nav link (mobile)
const navLinks = document.querySelectorAll('.nav-links a');
navLinks.forEach(link => {
  link.addEventListener('click', () => {
    if (window.innerWidth <= 768) {
      toggleMenu();
    }
  });
});

// Attendance functionality
let attendanceData = {};

function setStatus(attendanceId, status, btn) {
    attendanceData[attendanceId] = status;
    const statusBadge = document.getElementById('status-' + attendanceId);
    statusBadge.innerText = status;
    statusBadge.className = 'status-badge status-' + status.toLowerCase();
    
    let btnGroup = btn.parentNode.children;
    for (let b of btnGroup) b.classList.remove('active');
    btn.classList.add('active');
}

function saveAttendance() {
    if (Object.keys(attendanceData).length === 0) {
        alert('No changes to save!');
        return;
    }

    let updates = [];
    for (let id in attendanceData) {
        updates.push({attendance_id: id, status: attendanceData[id]});
    }

    fetch("{% url 'update_attendance_ajax' %}", {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token }}',
            'X-Requested-With': 'XMLHttpRequest'
        },
        body: JSON.stringify({updates: updates})
    })
    .then(res => res.json())
    .then(data => {
        if (data.success) {
            alert('Attendance saved successfully!');
            attendanceData = {};
            location.reload();
        } else {
            alert('Error: ' + data.message);
        }
    })
    .catch(err => {
        console.error(err);
        alert('An error occurred while saving attendance.');
    });
}
</script>

</body>
</html>